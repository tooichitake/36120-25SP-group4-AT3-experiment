Loaded 10 files: 3653 records from 2015-01-01 to 2024-12-31

timeOpen	timeClose	timeHigh	timeLow	name	open	high	low	close	volume	marketCap	timestamp
0	2015-01-01 00:00:00+00:00	2015-01-01T23:59:59.999Z	2015-01-01T00:04:00.000Z	2015-01-01T23:44:00.000Z	2781	320.434998	320.434998	314.002991	314.248993	8036550.0	4.297536e+09	2015-01-01T23:59:59.999Z
1	2015-01-02 00:00:00+00:00	2015-01-02T23:59:59.999Z	2015-01-02T20:19:01.000Z	2015-01-02T01:04:01.000Z	2781	314.079010	315.838989	313.565002	315.032013	7860650.0	4.309551e+09	2015-01-02T23:59:59.999Z
2	2015-01-03 00:00:00+00:00	2015-01-03T23:59:59.999Z	2015-01-03T00:24:01.000Z	2015-01-03T23:59:00.000Z	2781	314.846008	315.149994	281.082001	281.082001	33054400.0	3.846270e+09	2015-01-03T23:59:59.999Z
3	2015-01-04 00:00:00+00:00	2015-01-04T23:59:59.999Z	2015-01-04T10:14:01.000Z	2015-01-04T15:29:01.000Z	2781	281.145996	287.230011	257.612000	264.195007	55629100.0	3.616321e+09	2015-01-04T23:59:59.999Z
4	2015-01-05 00:00:00+00:00	2015-01-05T23:59:59.999Z	2015-01-05T08:54:00.000Z	2015-01-05T00:04:01.000Z	2781	265.084015	278.341003	265.084015	274.473999	43962800.0	3.758098e+09	2015-01-05T23:59:59.999Z
Created target 'next_day_high' (3652 samples)
Target Variable Statistics:
count      3652.000000
mean      20578.446908
std       22657.863974
min         211.731003
25%        2684.457458
50%        9835.382157
75%       33335.570609
max      108268.447080
Name: next_day_high, dtype: float64
Cleaned data: 3652 samples, 8 columns
Added 54 technical indicators
Removed 199 warmup rows (3453 samples remaining)

Feature Correlation with 'next_day_high' (Total: 60 features):
============================================================
  close          :  0.9995
  VWAP           :  0.9994
  high           :  0.9993
  low            :  0.9989
  marketCap      :  0.9989
  open           :  0.9987
  TEMA_20        :  0.9984
  SMA_7          :  0.9979
  DEMA_20        :  0.9978
  HMA_20         :  0.9978
  EMA_12         :  0.9972
  KCBe_20_2.0    :  0.9951
  DCM_20_20      :  0.9944
  KCUe_20_2.0    :  0.9942
  KCLe_20_2.0    :  0.9942
  DCU_20_20      :  0.9940
  BBM_20_2.0     :  0.9935
  SMA_20         :  0.9935
  EMA_26         :  0.9935
  BBU_20_2.0     :  0.9934
  DCL_20_20      :  0.9894
  BBL_20_2.0     :  0.9865
  EMA_50         :  0.9865
  SMA_50         :  0.9817
  SMA_200        :  0.9262
  ATRr_14        :  0.9019
  AD             :  0.8741
  OBV            :  0.8286
  volume         :  0.6493
  MACDs_12_26_9  :  0.3725
  MACD_12_26_9   :  0.3504
  ADOSC_3_10     :  0.2429
  DMP_14         : -0.1429
  DMN_14         : -0.1067
  AROONU_25      :  0.0859
  NATR_14        :  0.0750
  CMF_20         : -0.0746
  sma20_50_ratio :  0.0553
  ADX_14         : -0.0456
  bb_width_pct   : -0.0446
  BBB_20_2.0     : -0.0446
  price_to_sma50 :  0.0436
  RSI_21         :  0.0388
  AROONOSC_25    :  0.0378
  STOCHd_14_3_3  :  0.0319
  STOCHk_14_3_3  :  0.0284
  volume_surge   : -0.0259
  WILLR_14       :  0.0236
  ROC_21         :  0.0235
  AROOND_25      :  0.0234
  price_to_sma20 :  0.0214
  RSI_14         :  0.0205
  MACDh_12_26_9  : -0.0168
  price_momentum_10:  0.0113
  ROC_10         :  0.0113
  MFI_14         : -0.0102
  bb_position    : -0.0089
  BBP_20_2.0     : -0.0089
  price_momentum_5:  0.0053
  CCI_14_0.015   :  0.0010
============================================================
Testing different feature counts...
   N         R2          MAE     MAPE
----------------------------------------
   3   0.997627 $    753.14    1.50%
   5   0.997575 $    662.93    1.31%
   7   0.997560 $    663.34    1.31%
  10   0.997592 $    669.86    1.33%
  12   0.997557 $    668.77    1.33%
  15   0.997624 $    684.48    1.34%
  20   0.997600 $    676.84    1.33%
  25   0.997593 $    678.17    1.33%
  30   0.997328 $    656.50    1.28%
  40   0.997125 $    666.97    1.29%
  50   0.997233 $    660.67    1.28%
  60   0.997180 $    663.68    1.29%
----------------------------------------

Optimal Feature Count:
  Best R2:   N= 3  (R2=0.997627)
  Best MAPE: N=30  (MAPE=1.28%)
  Best MAE:  N=30  (MAE=$656.50)
Cleaned data: 3652 samples, 8 columns
	date	open	high	low	close	volume	marketCap	next_day_high
0	2015-01-01 00:00:00+00:00	320.434998	320.434998	314.002991	314.248993	8036550.0	4.297536e+09	315.838989
1	2015-01-02 00:00:00+00:00	314.079010	315.838989	313.565002	315.032013	7860650.0	4.309551e+09	315.149994
2	2015-01-03 00:00:00+00:00	314.846008	315.149994	281.082001	281.082001	33054400.0	3.846270e+09	287.230011
3	2015-01-04 00:00:00+00:00	281.145996	287.230011	257.612000	264.195007	55629100.0	3.616321e+09	278.341003
4	2015-01-05 00:00:00+00:00	265.084015	278.341003	265.084015	274.473999	43962800.0	3.758098e+09	287.553009
Added 54 technical indicators
Removed 199 warmup rows (3453 samples remaining)
	date	open	high	low	close	volume	marketCap	next_day_high	SMA_7	SMA_20	...	AROONU_25	AROONOSC_25	price_to_sma20	price_to_sma50	sma20_50_ratio	bb_width_pct	bb_position	volume_surge	price_momentum_5	price_momentum_10
0	2015-07-19 00:00:00+00:00	274.766998	275.670013	272.513000	273.614014	15332500.0	3.940582e+09	278.980988	281.631853	275.089448	...	72.0	68.0	-0.536347	8.479187	1.090641	20.102554	0.473319	0.402964	-4.817986	1.629109
1	2015-07-20 00:00:00+00:00	273.498993	278.980988	272.959991	278.980988	22711400.0	4.018965e+09	280.546997	279.764282	275.884898	...	68.0	68.0	1.122240	10.180751	1.089580	19.668955	0.557056	0.614516	-2.395846	-2.075517
2	2015-07-21 00:00:00+00:00	278.881989	280.546997	275.419006	275.833008	22930700.0	3.974491e+09	277.665985	278.102713	276.745498	...	64.0	64.0	-0.329722	8.484131	1.088430	18.755972	0.482420	0.623910	-0.811244	-5.895974
3	2015-07-22 00:00:00+00:00	275.657013	277.665985	274.381012	277.221985	19389800.0	3.995573e+09	278.110992	276.873138	277.835997	...	60.0	60.0	-0.220998	8.591204	1.088317	17.303820	0.487228	0.529124	-0.805090	-10.822963
4	2015-07-23 00:00:00+00:00	277.341003	278.110992	275.716003	276.049011	18531300.0	3.979626e+09	289.252991	276.581713	278.821648	...	56.0	56.0	-0.994412	7.708353	1.087902	15.750246	0.436864	0.506043	0.417609	-5.480142
Split: Train 2071 | Val 690 | Test 692
  Train: 2015-07-19 to 2021-03-19
  Val:   2021-03-20 to 2023-02-07
  Test:  2023-02-08 to 2024-12-30
  Using 30 optimal features for modeling

Log-transformed 30 features (2 signed)
Normalized 31 features to [0, 1]
Training TimesNet | Device: cuda | Params: 11,148,805
Training:  13%|‚ñè| 20/150 [00:11<01:15,  1.71it/s, Train Loss=0.012671, Val Loss=0.019362, Status=Pat
Training completed: 21 epochs | 11.7s | Best Val Loss: 0.018944

TEST SET PERFORMANCE:
============================================================
  MAE:  $7,279.81
  RMSE: $8,213.18
  MAPE: 14.31%
  R2:   0.8572
============================================================